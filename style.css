/* --- Root Variables for Narrative BG --- */
:root {
    /* ... existing vars ... */
    --rgb-primary-serious-color: 0, 106, 112;
    --rgb-primary-vibrant-accent: 253, 184, 19;
    --rgb-secondary-vibrant-accent: 0, 160, 154;
    --narrative-bg-depth: -1; /* To ensure they are behind content (or 0 if section uses z-index on its own) */
}

/* --- Keyframes for Narrative Animations --- */
@keyframes sparkleFloat {
    0% { transform: translateY(0) translateX(0) scale(0.5); opacity: 0; }
    50% { opacity: 0.08; }
    100% { transform: translateY(-150px) translateX(20px) scale(1.2); opacity: 0; }
}

@keyframes tangledLines {
    0% { transform: scaleX(0.5) rotate(-5deg); opacity: 0.1; }
    50% { transform: scaleX(1) rotate(5deg); opacity: 0.05; }
    100% { transform: scaleX(0.5) rotate(-5deg); opacity: 0.1; }
}
@keyframes clearPath {
    0% { transform: scale(0); opacity: 0; }
    50% { opacity: 0.1; }
    100% { transform: scale(1.5); opacity: 0; }
}

@keyframes flowUp {
    0% { transform: translateY(50px) scale(0.7); opacity: 0; }
    70% { opacity: 0.09; }
    100% { transform: translateY(-180px) scale(1); opacity: 0; }
}

@keyframes drawPath {
    to { stroke-dashoffset: 0; }
}

@keyframes guidingAuraPulse {
    0% { transform: scale(0.8); opacity: 0.03; }
    50% { transform: scale(1.2); opacity: 0.08; }
    100% { transform: scale(0.8); opacity: 0.03; }
}

@keyframes voiceRipple {
    0% { transform: scale(0.5); opacity: 0; }
    50% { opacity: 0.07; }
    100% { transform: scale(2.5); opacity: 0; }
}

@keyframes convergeLines {
    0% { transform: translateY(80px) rotate(10deg) scaleX(0.5); opacity: 0; }
    70% { opacity: 0.1; }
    100% { transform: translateY(-50px) rotate(-5deg) scaleX(1.5); opacity: 0; }
}


/* --- Generic Narrative Background Container --- */
.narrative-background {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    overflow: hidden; /* Important to contain child elements */
    z-index: var(--narrative-bg-depth); 
    pointer-events: none; /* So they don't interfere with interactions */
}

/* --- Hero Section Narrative --- */
.hero-narrative-bg .narrative-spark {
    position: absolute;
    width: 8px;
    height: 8px;
    background-color: rgba(var(--rgb-primary-vibrant-accent), 0.6);
    border-radius: 50%;
    opacity: 0;
    animation: sparkleFloat 6s infinite;
}
.hero-narrative-bg .narrative-spark:nth-child(1) { top: 20%; left: 15%; animation-delay: 0s; width:6px; height: 6px;}
.hero-narrative-bg .narrative-spark:nth-child(2) { top: 40%; left: 80%; animation-delay: 1s; width:10px; height: 10px;}
.hero-narrative-bg .narrative-spark:nth-child(3) { top: 70%; left: 10%; animation-delay: 2s; }
.hero-narrative-bg .narrative-spark:nth-child(4) { top: 50%; left: 55%; animation-delay: 2.5s; background-color: rgba(var(--rgb-secondary-vibrant-accent), 0.5);}
.hero-narrative-bg .narrative-spark:nth-child(5) { top: 85%; left: 70%; animation-delay: 3.5s; width:7px; height: 7px;}

/* --- Pain Point Section Narrative --- */
.pain-narrative-bg .narrative-blockage-line {
    position: absolute;
    height: 2px;
    width: 150px;
    background-color: rgba(var(--rgb-primary-serious-color), 0.4);
    opacity: 0.1;
    animation: tangledLines 8s infinite alternate;
}
.pain-narrative-bg .narrative-blockage-line:nth-child(1) {
    top: 30%; left: 10%; transform: rotate(15deg); animation-delay: 0s;
}
.pain-narrative-bg .narrative-blockage-line:nth-child(2) {
    top: 60%; right: 5%; transform: rotate(-10deg); animation-delay: 1s; width: 200px;
}
.pain-narrative-bg .narrative-clearing-element {
    position: absolute;
    top: 50%; left: 50%;
    width: 100px; height: 100px;
    border-radius: 50%;
    background-color: rgba(var(--rgb-secondary-vibrant-accent), 0.05);
    animation: clearPath 7s ease-in-out 2s infinite; /* Starts after lines a bit */
    transform: translate(-50%, -50%) scale(0);
    opacity: 0;
}


/* --- Benefits Section Narrative --- */
.benefits-narrative-bg .narrative-flow-particle {
    position: absolute;
    width: 12px;
    height: 12px;
    background-color: rgba(var(--rgb-primary-vibrant-accent), 0.5);
    border-radius: 60% 40% 70% 30% / 50% 60% 40% 50%; /* Organic shape */
    opacity: 0;
    animation: flowUp 5s infinite;
}
.benefits-narrative-bg .narrative-flow-particle:nth-child(1) { bottom: 0%; left: 20%; animation-delay: 0s; }
.benefits-narrative-bg .narrative-flow-particle:nth-child(2) { bottom: 0%; left: 75%; animation-delay: 1s; background-color: rgba(var(--rgb-secondary-vibrant-accent),0.5); width: 15px; height: 15px; }
.benefits-narrative-bg .narrative-flow-particle:nth-child(3) { bottom: 0%; left: 45%; animation-delay: 1.8s; width: 10px; height: 10px; }
.benefits-narrative-bg .narrative-flow-particle:nth-child(4) { bottom: 0%; left: 90%; animation-delay: 2.5s; }

/* --- Quiz Section Narrative --- */
.quiz-narrative-bg {
    z-index: 0; /* Ensure SVG is visible and respects parent overflow */
}
.quiz-narrative-bg .narrative-quiz-path {
    width: 100%; height: 100%;
    position: absolute;
    top:0; left:0;
}
.narrative-quiz-path path {
    stroke-dasharray: 1000; /* A large enough value */
    stroke-dashoffset: 1000; /* Start with path "undrawn" */
    animation: drawPath 15s ease-in-out infinite alternate;
}
.narrative-quiz-path path:nth-child(2) {
    animation-delay: 1s; /* Stagger second path */
}

/* --- About Teacher Section Narrative --- */
.teacher-narrative-bg .narrative-guiding-aura {
    position: absolute;
    top: 50%;
    left: 50%; /* Default center */
    width: 300px; height: 300px;
    background: radial-gradient(circle, rgba(var(--rgb-primary-vibrant-accent), 0.1) 0%, rgba(var(--rgb-primary-vibrant-accent), 0) 70%);
    border-radius: 50%;
    transform: translate(-50%, -50%);
    animation: guidingAuraPulse 8s ease-in-out infinite;
}
@media (min-width: 860px) { /* Align with teacher photo more specifically */
    .teacher-narrative-bg .narrative-guiding-aura {
       left: calc(100% - 140px - 25px); /* Adjust to be roughly behind photo: (teacher-photo-area flex:1 of max-width: 280px) / 2 - (gap/2)  */
       /* Approx: calc(100% - photo_half_width - half_gap) for right side */
    }
}
@media (max-width: 859px) { /* Center when stacked */
     .teacher-narrative-bg .narrative-guiding-aura {
        top: 70%; /* Lower if photo is at bottom */
     }
}


/* --- Testimonials Section Narrative --- */
.testimonials-narrative-bg .narrative-voice-ripple {
    position: absolute;
    width: 50px; height: 50px;
    border: 2px solid rgba(var(--rgb-secondary-vibrant-accent), 0.3);
    border-radius: 50%;
    opacity: 0;
    animation: voiceRipple 5s infinite;
}
.testimonials-narrative-bg .narrative-voice-ripple:nth-child(1) { top: 20%; left: 15%; animation-delay: 0s; }
.testimonials-narrative-bg .narrative-voice-ripple:nth-child(2) { top: 50%; left: 80%; animation-delay: 1.5s; border-color: rgba(var(--rgb-primary-serious-color),0.3); }
.testimonials-narrative-bg .narrative-voice-ripple:nth-child(3) { top: 75%; left: 40%; animation-delay: 2.5s; }

/* --- Final CTA Section Narrative --- */
/* This section already has a strong background, so make this one extra subtle or related */
.final-cta-narrative-bg .narrative-converging-line {
    position: absolute;
    width: 3px;
    height: 80px;
    background-color: rgba(var(--rgb-primary-vibrant-accent), 0.5); /* Use the accent that's also in main bg animation */
    opacity: 0;
    animation: convergeLines 7s infinite;
    bottom: 0; /* Start from bottom */
}
.final-cta-narrative-bg .narrative-converging-line:nth-child(1) { left: 25%; transform-origin: bottom center; animation-delay: 0s; }
.final-cta-narrative-bg .narrative-converging-line:nth-child(2) { left: 50%; transform-origin: bottom center; animation-delay: 0.8s; height: 100px;}
.final-cta-narrative-bg .narrative-converging-line:nth-child(3) { left: 75%; transform-origin: bottom center; animation-delay: 1.5s; }

/* Adjust Hero BG z-index due to its existing SVG background */
.hero-section .hero-background-shape {
    z-index: -1; /* Ensure narrative can be seen if it overlaps, or give it a positive z-index like 1 if the narrative should be on top of this specific svg */
}
/* Or, to be more robust if other content is layered in hero: */
.hero-section .hero-content-wrapper { z-index: 2; }
.hero-section .hero-background-shape { z-index: 0; } /* svg behind content */
.hero-section .hero-narrative-bg { z-index: 1; } /* narrative above svg but behind content */
/* Ensure sticky header is above all narrative BGs */
.sticky-header { z-index: 1000; }
