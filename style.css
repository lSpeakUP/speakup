/* --- Global Styles & Variables --- */
:root {
    --main-background: #FFFFFF;
    --off-white-section-bg: #F7F9FA;
    --primary-serious-color: #006A70;
    --primary-vibrant-accent: #FDB813;
    --secondary-vibrant-accent: #00A09A;
    --main-text-color: #1f1f1f;
    
    --white: #FFFFFF;
    --light-text-on-dark-bg: #EFF3F4;
    --medium-grey-text: #586065;
    --border-light: #DEE2E6;
    --cloud-color-base: 230, 238, 240; /* For rgba clouds */
    --soundwave-color-base: var(--secondary-vibrant-accent);

    --font-primary: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";

    --shadow-sm: 0 1px 2px rgba(0,0,0,0.03), 0 1px 1px rgba(0,0,0,0.02);
    --shadow-md: 0 3px 5px -1px rgba(0,0,0,0.04), 0 2px 3px -1px rgba(0,0,0,0.03);
    --shadow-lg: 0 8px 12px -3px rgba(0,0,0,0.04), 0 3px 5px -2px rgba(0,0,0,0.02);

    --rgb-primary-serious-color: 0, 106, 112;
    --rgb-primary-vibrant-accent: 253, 184, 19;
    --rgb-secondary-vibrant-accent: 0, 160, 154;
    --rgb-medium-grey-text: 88, 96, 101;
}

/* === ALL KEYFRAMES (Original, Narrative, New Creative) === */
/* Keep all existing @keyframes definitions from the previous full CSS you have. */
/* ... (Your drawLine, fadeIn, gentleWave, pulseGlow, slideUpFadeIn, etc.) ... */
/* ... (Your teacherFrameReveal, svgGentleBob, sparkleFloat, potentialLineDrift etc.) ... */

@keyframes cloudDrift {
    from { transform: translateX(-150%); opacity: 0; } /* Start off-screen left */
    20%, 80% { opacity: 1; } /* Fade in and out at edges of screen time */
    to { transform: translateX(150%); opacity: 0; } /* End off-screen right */
}
@keyframes distantWavePulse {
    0%, 100% { transform: scale(0.8); opacity: 0.05; }
    50% { transform: scale(1.2); opacity: 0.15; }
}
@keyframes blockedWaveJitter {
    0%, 100% { transform: translateX(0) scaleX(1); opacity: 0.1; }
    25% { transform: translateX(-3px) scaleX(0.95); opacity: 0.08; }
    50% { transform: translateX(3px) scaleX(1.05); opacity: 0.12; }
    75% { transform: translateX(-2px) scaleX(1); opacity: 0.09; }
}
@keyframes barrierLineAppear {
    from { width: 0; opacity: 0; }
    to { width: 100%; opacity: 0.2; } /* Width is relative to its own max-width */
}
@keyframes flowingWave {
    0% { transform: translateX(-20%) scaleY(0.8); opacity: 0.1; }
    50% { transform: translateX(0) scaleY(1.2); opacity: 0.2; }
    100% { transform: translateX(20%) scaleY(0.8); opacity: 0.1; }
}
@keyframes pathSoundNodeGlow {
    0%, 100% { background-color: rgba(var(--rgb-primary-vibrant-accent), 0.5); box-shadow: 0 0 5px rgba(var(--rgb-primary-vibrant-accent),0.3); }
    50% { background-color: rgba(var(--rgb-secondary-vibrant-accent), 0.7); box-shadow: 0 0 12px rgba(var(--rgb-secondary-vibrant-accent),0.5); }
}
@keyframes gentleSoundWaveExpand {
    0%, 100% { transform: scale(0.9); opacity: 0.08; }
    50% { transform: scale(1.1); opacity: 0.18; }
}
@keyframes speechBubbleEcho {
    0% { transform: scale(0.5) translateY(10px); opacity: 0; }
    70% { transform: scale(1.2) translateY(-5px); opacity: 0.25; }
    100% { transform: scale(1.5) translateY(-15px); opacity: 0; }
}
@keyframes positiveSoundRipple { /* Re-using for stronger effect */
    0% { transform: scale(0.3); opacity: 0; border-width: 4px; }
    50% { opacity: 0.2; }
    100% { transform: scale(3); opacity: 0; border-width: 1px; }
}
@keyframes focusedSoundWavePropagate {
    0% { width: 10%; opacity: 0.1; transform: translateX(-50%); } /* Start narrow from left */
    50% { opacity: 0.3; }
    100% { width: 100%; opacity: 0.05; transform: translateX(0%); } /* Expand right */
}
@keyframes starburst {
    0% { transform: scale(0) rotate(0deg); opacity: 0; }
    50% { opacity: 0.25; }
    100% { transform: scale(1.5) rotate(360deg); opacity: 0; }
}

/* ... (And all other existing @keyframes) ... */


/* --- Base Scroll Animation Styles --- */
/* (No change from your previous version) */
.animated-title, .animated-text, .benefit-item, .testimonial-card,
.quiz-placeholder, .blockage-element, .quiz-cta, .animated-teacher-frame {
    opacity: 0;
    transition: opacity 0.6s ease-out, transform 0.6s ease-out;
}
.animated-title.in-view, .animated-text.in-view {
     animation: slideUpFadeIn 0.8s ease-out forwards;
}

/* --- CSS Reset/Normalization --- */
/* (No change from your previous version) */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; font-size: 16px; -webkit-text-size-adjust: 100%; }
body {
    font-family: var(--font-primary); line-height: 1.7; color: var(--main-text-color);
    background-color: var(--main-background);
    -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
    overflow-x: hidden;
}
img, svg { max-width: 100%; height: auto; display: block; }

/* --- Utility Classes & Base Section Styling --- */
/* (No change needed from your "mobile optimized" CSS version for .container, .section, .section-title, .cta-button etc.) */
/* ... (Paste your existing mobile-optimized utility, section, cta, header, hero, pain-point, benefits, quiz, teacher, testimonials, final-cta, footer CSS here) ... */

/* Ensure this existing mobile optimized base is here from previous iterations: */
.container { width: 90%; max-width: 1140px; margin-left: auto; margin-right: auto; padding-left: 15px; padding-right: 15px; position: relative; z-index: 2; }
.section { padding: 60px 0; position: relative; overflow: hidden; }
#pain-point.section { padding-top: 30px; }
@media (min-width: 768px) { .section { padding: 80px 0; } #pain-point.section { padding-top: 40px; } }
.section-title { font-size: 2rem; font-weight: 700; color: var(--primary-serious-color); text-align: center; margin-bottom: 35px; letter-spacing: -0.5px; }
.section-title .highlight { color: var(--secondary-vibrant-accent); }
.section-subtitle.highlight-text-main { color: var(--main-text-color); font-weight: 500; font-size: 1.1rem; display: block; margin-top: -15px; }
@media (min-width: 768px) { .section-title { font-size: 2.3rem; margin-bottom: 45px; } .section-subtitle.highlight-text-main { font-size: 1.2rem; margin-top: -18px; } }
.cta-button { display: inline-block; padding: 12px 28px; background-color: var(--primary-vibrant-accent); color: var(--main-text-color); text-decoration: none; font-weight: 600; font-size: 1rem; border-radius: 8px; transition: background-color 0.25s ease, transform 0.2s ease, box-shadow 0.25s ease, color 0.25s ease; border: none; cursor: pointer; text-align: center; box-shadow: var(--shadow-sm); }
.cta-button:hover, .cta-button:focus { background-color: #EAA703; transform: translateY(-3px) scale(1.02); box-shadow: var(--shadow-md); color: var(--main-text-color); }
.cta-button-large { font-size: 1.1rem; padding: 15px 35px; }
@media (min-width: 768px) { .cta-button { padding: 15px 35px; font-size: 1.05rem; } .cta-button-large { font-size: 1.2rem; padding: 18px 40px; } }

/* Header, Hero, Pain Point, Benefits, Quiz, Teacher (Frame and SVG), Testimonials, Final CTA (Button fix) and Footer */
/* Make sure ALL styles from your last *working and mobile-optimized* CSS are here for these sections */
/* ... For example, ensure final-cta-button styles include the opacity and z-index fixes ... */

/* === NARRATIVE BACKGROUND STYLES === */
/* Generic Narrative Background Container (No change) */
.narrative-background {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    overflow: hidden; z-index: 1; pointer-events: none;
}
.hero-section .hero-background-shape { z-index: 0; }

/* --- NEW CREATIVE NARRATIVE ELEMENTS --- */

/* Clouds */
.narrative-cloud {
    position: absolute;
    border-radius: 50%;
    opacity: 0; /* Start invisible, animation brings them in */
    background-color: rgba(var(--cloud-color-base), 0.4); /* Base soft cloud color */
    animation-name: cloudDrift;
    animation-timing-function: linear;
    animation-iteration-count: infinite;
    z-index: -1; /* Keep clouds furthest back in narrative layer */
}
.narrative-cloud.style1 { /* Typical fluffy */
    width: 150px; height: 50px;
    border-radius: 25px / 40px; /* More oval */
    animation-duration: 60s; /* Slow drift */
}
.narrative-cloud.style1::before, .narrative-cloud.style1::after {
    content: ''; position: absolute; background-color: inherit; border-radius: 50%;
}
.narrative-cloud.style1::before { width: 80px; height: 80px; top: -30px; left: 20px; }
.narrative-cloud.style1::after { width: 100px; height: 100px; top: -40px; right: 10px; }

.narrative-cloud.style2 { /* Longer, thinner */
    width: 200px; height: 40px;
    border-radius: 20px;
    animation-duration: 75s;
    left: -200px; /* Ensures it starts off-screen properly */
}
.narrative-cloud.style2::before {
    content: ''; position: absolute; background-color: inherit; border-radius: 50%;
    width: 120px; height: 60px; top: -20px; left: 50%; transform: translateX(-50%);
}
.narrative-cloud.style3 { /* Smaller, scattered */
    width: 100px; height: 35px;
    border-radius: 20px / 30px;
    animation-duration: 50s;
}
.narrative-cloud.style3::before { content: ''; position: absolute; background-color: inherit; border-radius: 50%; width: 50px; height: 50px; top: -20px; left: 10px; }
.narrative-cloud.style3::after { content: ''; position: absolute; background-color: inherit; border-radius: 50%; width: 60px; height: 60px; top: -25px; right: 5px; }

/* Cloud Modifiers */
.narrative-cloud.dense { background-color: rgba(var(--cloud-color-base), 0.55); }
.narrative-cloud.bright { background-color: rgba(var(--cloud-color-base), 0.3); box-shadow: 0 0 20px 10px rgba(var(--white), 0.3); }
.narrative-cloud.wispy { background-color: rgba(var(--cloud-color-base), 0.25); transform: scale(0.8); }
.narrative-cloud.calm { animation-duration: 90s; } /* Even slower */
.narrative-cloud.clear-sky { background-color: rgba(var(--cloud-color-base), 0.15); }
.narrative-cloud.sunset-glow { background-image: linear-gradient(to top, rgba(var(--rgb-primary-vibrant-accent),0.2), rgba(var(--cloud-color-base), 0.3)); }
.narrative-cloud.tiny-transition { width: 60px; height: 20px; animation-duration: 20s; opacity: 0.7 !important; transform: translateX(0) !important; /* override drift temporarily for static placement */ }

/* Sound Waves (General structure for a simple div-based wave) */
.narrative-soundwave-base { /* Common for different wave types */
    position: absolute;
    border-radius: 50%;
    border: 2px solid var(--soundwave-color-base);
    opacity: 0;
}
.narrative-distant-wave {
    position: absolute;
    width: 80px; height: 80px;
    border: 2px solid rgba(var(--rgb-secondary-vibrant-accent), 0.2);
    border-radius: 50%;
    opacity: 0;
    animation: distantWavePulse 5s infinite ease-in-out;
}
.narrative-distant-wave.delayed { animation-delay: 2.5s; }

.narrative-blocked-wave {
    position: absolute;
    width: 100px; height: 30px; /* More elongated */
    border: 2px solid rgba(var(--rgb-medium-grey-text), 0.4);
    border-radius: 15px; /* Oval */
    opacity: 0.1;
    animation: blockedWaveJitter 1s infinite;
    left: 20%; top: 60%;
}
.narrative-flowing-wave {
    position: absolute;
    width: 150px; height: 150px; /* Larger flowing */
    border: 2px solid rgba(var(--rgb-secondary-vibrant-accent), 0.3);
    border-radius: 50%;
    opacity: 0;
    animation: flowingWave 6s infinite ease-in-out alternate;
    top: 20%; left: 10%;
}
.narrative-flowing-wave.alt { top: 60%; left: 70%; animation-delay: 1s; border-color: rgba(var(--rgb-primary-vibrant-accent), 0.3); }

.narrative-teacher-soundwave.gentle {
    position: absolute;
    width: 120px; height: 120px;
    border: 2px solid rgba(var(--rgb-primary-vibrant-accent), 0.25);
    border-radius: 50%;
    opacity: 0;
    animation: gentleSoundWaveExpand 5s infinite ease-in-out 0.5s;
    /* Position near teacher aura - needs media query adjustments */
    top: 50%; left: 50%; transform: translate(-150%, -50%); /* Example */
}

.narrative-positive-sound-ripple { /* Reuse of existing voice ripple */
    position: absolute; width: 60px; height: 60px;
    border: 3px solid rgba(var(--rgb-secondary-vibrant-accent), 0.5); /* Stronger */
    border-radius: 50%; opacity: 0;
    animation: positiveSoundRipple 4s infinite linear;
}
.narrative-positive-sound-ripple.large { width: 90px; height: 90px; animation-duration: 5s; }
.narrative-positive-sound-ripple.small { width: 40px; height: 40px; animation-duration: 3.5s; }

.narrative-focused-soundwave.strong {
    position: absolute;
    height: 4px; /* Thicker line for focus */
    background-color: rgba(var(--rgb-primary-vibrant-accent), 0.6);
    border-radius: 2px;
    opacity: 0;
    animation: focusedSoundWavePropagate 3s infinite ease-out;
    left: 0; /* Animation handles x-translation for propagate effect */
    /* Positioning based on section */
}
.narrative-focused-soundwave.strong.delayed { animation-delay: 0.8s; }

/* Barrier Lines (Pain Point) */
.narrative-barrier-line {
    position: absolute;
    height: 2px;
    max-width: 150px; /* Control its length */
    background-color: rgba(var(--rgb-medium-grey-text), 0.5);
    opacity: 0;
    animation: barrierLineAppear 1.5s forwards ease-out;
    top: 30%; left: 10%;
}
.narrative-barrier-line.slanted { top: 70%; right: 15%; left: auto; transform: rotate(15deg); max-width: 120px; animation-delay: 0.5s; }

/* Path Sound Node (Quiz) - different from quiz-node */
.narrative-path-sound-node {
    position: absolute;
    width: 12px; height: 12px;
    background-color: rgba(var(--rgb-primary-vibrant-accent), 0.5);
    border-radius: 50%;
    opacity: 0.7;
    box-shadow: 0 0 8px rgba(var(--rgb-primary-vibrant-accent), 0.4);
    animation: pathSoundNodeGlow 2.5s infinite ease-in-out;
    /* Position these on top of your SVG paths manually or with JS */
}

/* Speech Bubble Echo (Testimonials) */
.narrative-speech-bubble-echo {
    position: absolute;
    width: 50px; height: 40px;
    background-color: rgba(var(--rgb-secondary-vibrant-accent), 0.1);
    border: 1px solid rgba(var(--rgb-secondary-vibrant-accent), 0.2);
    border-radius: 10px 10px 10px 3px; /* Speech bubble shape */
    opacity: 0;
    animation: speechBubbleEcho 4s infinite ease-out;
    transform-origin: bottom left;
}
.narrative-speech-bubble-echo::after { /* Tail of bubble */
    content: ''; position: absolute;
    bottom: -8px; left: 10px;
    width: 0; height: 0;
    border-left: 8px solid transparent;
    border-right: 8px solid transparent;
    border-top: 10px solid rgba(var(--rgb-secondary-vibrant-accent), 0.15);
}
.narrative-speech-bubble-echo.delayed { animation-delay: 1.5s; }

/* Starburst (Final CTA) */
.narrative-starburst-element {
    position: absolute;
    width: 50px; height: 50px;
    opacity: 0;
    animation: starburst 3.5s infinite ease-out;
}
.narrative-starburst-element::before, .narrative-starburst-element::after {
    content: ''; position: absolute;
    top: 50%; left: 50%;
    width: 100%; height: 4px; /* Line thickness */
    background-color: rgba(var(--rgb-primary-vibrant-accent), 0.5);
    border-radius: 2px;
    transform-origin: center;
    transform: translate(-50%, -50%) rotate(0deg);
}
.narrative-starburst-element::after { transform: translate(-50%, -50%) rotate(90deg); }
/* Could add more pseudo-elements for more points to the star */


/* --- Placement of new narrative elements within sections --- */
/* These are examples. Adjust top/left/right/bottom and animation delays! */

/* Hero BG Elements */
.hero-narrative-bg .narrative-cloud.style1 { top: 10%; left: -150px; animation-delay: 0s; }
.hero-narrative-bg .narrative-cloud.style2 { top: 60%; left: -200px; animation-delay: 10s; }
.hero-narrative-bg .narrative-cloud.style3 { top: 30%; left: -100px; animation-delay: 20s; }
.hero-narrative-bg .narrative-distant-wave:nth-of-type(4) { top: 20%; left: 25%;} /* Adjust selector if more elements */
.hero-narrative-bg .narrative-distant-wave.delayed { top: 70%; right: 20%; left:auto; }
/* Sparks are from previous iteration */

/* Transition Element */
.narrative-transition-element-area .narrative-cloud.tiny-transition {
    position: absolute; /* Ensure it's positioned */
    top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.6); /* Center & small */
    animation: none; /* No drift in this static placement */
}


/* Pain Point BG Elements */
.pain-narrative-bg .narrative-cloud.style2.dense { top: 15%; left: -200px; animation-delay: 1s; }
.pain-narrative-bg .narrative-blocked-wave { top: 55%; left: 40%; transform-origin: center; }
.pain-narrative-bg .narrative-barrier-line { top: 25%; left: 10%; }
.pain-narrative-bg .narrative-barrier-line.slanted { top: 70%; right: 10%; transform: rotate(20deg); }
/* Blockage fragments & clearing element from previous */

/* Benefits BG Elements */
.benefits-narrative-bg .narrative-cloud.style1.bright { top: 5%; left: -150px; animation-delay: 2s;}
.benefits-narrative-bg .narrative-cloud.style3.bright { top: 65%; left: -100px; animation-delay: 12s;}
.benefits-narrative-bg .narrative-flowing-wave { top: 25%; left: 15%; }
.benefits-narrative-bg .narrative-flowing-wave.alt { top: 50%; left: 60%; }
/* Energy wash & flow particles from previous */

/* Quiz BG Elements */
.quiz-narrative-bg .narrative-cloud.style1.wispy { top: 70%; left: -150px; animation-delay: 3s;}
.quiz-narrative-bg .narrative-path-sound-node:nth-of-type(2) { top: 30%; left: 35%; } /* Example, after SVG */
.quiz-narrative-bg .narrative-path-sound-node:nth-of-type(3) { top: 65%; left: 60%; animation-delay: 0.8s; }

/* Teacher BG Elements */
.teacher-narrative-bg .narrative-cloud.style3.calm { top: 10%; left: -100px; animation-delay: 5s;}
.teacher-narrative-bg .narrative-teacher-soundwave.gentle {
    /* Needs precise positioning relative to triangular frame using media queries if complex */
    /* Simple example for now */
    top: 50%; left: 20%;
    transform: translate(0, -50%); /* Default */
}
@media (min-width: 860px) { /* Desktop: relative to teacher on right */
    .teacher-narrative-bg .narrative-teacher-soundwave.gentle {
        left: auto; right: calc(100% - 150px - 15px + 130px); /* To the left of teacher */
        top: 50%;
        transform: translateY(-50%);
    }
}
@media (max-width: 859px) { /* Mobile: below stacked teacher */
     .teacher-narrative-bg .narrative-teacher-soundwave.gentle {
        top: calc(50% + 70px + 160px); /* Below where frame ends */
        left: 50%;
        transform: translateX(-50%);
    }
}


/* Testimonials BG Elements */
.testimonials-narrative-bg .narrative-cloud.style1.clear-sky { top: 10%; left: -150px; animation-delay: 0.5s; opacity:0.8 !important; /* Static cloud */ animation-name:none; transform: translateX(30vw); }
.testimonials-narrative-bg .narrative-speech-bubble-echo:nth-of-type(2) { top: 20%; left: 15%; } /* after cloud */
.testimonials-narrative-bg .narrative-speech-bubble-echo.delayed { top: 60%; left: 70%; }
.testimonials-narrative-bg .narrative-positive-sound-ripple.large { top: 40%; left: 40%; }
.testimonials-narrative-bg .narrative-positive-sound-ripple.small { top: 70%; left: 20%; animation-delay: 1s; }

/* Final CTA BG Elements */
.final-cta-narrative-bg .narrative-cloud.style2.sunset-glow { top: 20%; left: -200px; animation-delay: 1s; }
.final-cta-narrative-bg .narrative-focused-soundwave.strong:nth-of-type(2) { top: 30%; } /* After cloud */
.final-cta-narrative-bg .narrative-focused-soundwave.strong.delayed { top: 60%; animation-delay: 0.5s; }
.final-cta-narrative-bg .narrative-starburst-element { top: 45%; left: 45%; transform-origin: center; } /* Near center, under text potentially */


/* --- MOBILE OPTIMIZATIONS FOR NARRATIVE ELEMENTS --- */
@media (max-width: 768px) {
    .narrative-cloud.style1 { width: 120px; height: 40px; }
    .narrative-cloud.style1::before { width: 60px; height: 60px; top: -25px; }
    .narrative-cloud.style1::after { width: 80px; height: 80px; top: -30px; }
    .narrative-cloud.style2 { width: 160px; height: 30px; }
    .narrative-cloud.style2::before { width: 100px; height: 50px; top: -15px;}
    .narrative-cloud.style3 { width: 80px; height: 25px; }

    .narrative-distant-wave { width: 60px; height: 60px; }
    .narrative-blocked-wave { width: 80px; height: 25px; }
    .narrative-flowing-wave { width: 120px; height: 120px; }
    .narrative-teacher-soundwave.gentle { width: 100px; height: 100px; }
    .narrative-positive-sound-ripple { width: 50px; height: 50px; }
    .narrative-positive-sound-ripple.large { width: 70px; height: 70px; }
    .narrative-positive-sound-ripple.small { width: 30px; height: 30px; }

    .narrative-speech-bubble-echo { width: 40px; height: 30px; }
    .narrative-starburst-element { width: 40px; height: 40px; }
}

@media (max-width: 480px) {
    /* Hide some less critical or more complex elements on very small screens */
    .hero-narrative-bg .narrative-cloud.style2, .hero-narrative-bg .narrative-distant-wave.delayed { display: none; }
    .pain-narrative-bg .narrative-barrier-line.slanted { display: none; }
    .benefits-narrative-bg .narrative-cloud.style3.bright {display: none;}
    .teacher-narrative-bg .narrative-aura-ray:nth-of-type(3) {display:none;}
    .testimonials-narrative-bg .narrative-speech-bubble-echo.delayed {display:none;}
    .final-cta-narrative-bg .narrative-starburst-element {display:none;}

    .narrative-cloud.style1 { width: 100px; height: 35px; }
    .narrative-cloud.style1::before { width: 50px; height: 50px; top: -20px; }
    .narrative-cloud.style1::after { width: 60px; height: 60px; top: -25px; }

    .pain-narrative-bg .narrative-clearing-element.decisive { width:90px; height:90px;}

    /* Further reduce count or complexity */
    .benefits-narrative-bg .narrative-flow-particle:nth-child(3) {display:none;}
}
